# 🧾 mitmproxy 기반 HTTP/1.1 다운그레이드 실험 정리

## 1. 🎯 실험 개요 및 목표

- iPhone에서 "내 학습공간" 페이지로 직접 진입하는 것을 차단당함
- 서버는 모바일 디바이스 접근 시 "PC에서 접속해주세요" 메시지를 띄움
- 해당 우회 실험은 **요청/응답 구조를 분석하기 위한 선행 실험**
- **HTTP/2 기반 TLS 프록시 차단**을 회피하기 위해 HTTP/1.1로 다운그레이드 시도
- 궁극적으로는 "내 학습공간" 접근 → 출석 버튼 보임 여부 확인

---

## 2. 🛠 실험 환경 구성

| 항목 | 내용 |
|------|------|
| 디바이스 | iPhone + Windows 노트북 |
| 프록시 도구 | mitmproxy (v10+) |
| 포트 설정 | 기본 8080 사용 실패 → 8888 포트로 재설정 |
| 인증서 설치 | iPhone Safari에서 http://mitm.it 접속 → 인증서 설치 및 신뢰 설정 완료 |
| 실행 명령어 | `mitmproxy --no-http2 -p 8888 -s ua_patch.py` |
| UA 스크립트 | 모든 요청의 User-Agent를 PC Chrome으로 변조 |

---

## 3. 🧪 진행한 실험 목록 및 결과

| 항목 | 내용 | 결과 |
|------|------|------|
| HTTP/2 차단 | `--no-http2` 옵션으로 HTTP/1.1 강제 사용 | ✅ 성공 |
| 프록시 연결 | iPhone에서 mitmproxy로 HTTPS 요청 전송 | ✅ 성공 |
| SSL 복호화 | Root CA 신뢰 설정 완료 → 요청 분석 가능 | ✅ 성공 |
| User-Agent 변조 | PC Chrome UA로 변조된 상태로 요청 송신 | ✅ 성공 |
| "내 학습공간" 접속 | `/my-page/user` 진입 시도 | ❌ 실패 |
| 차단 메시지 | 여전히 "PC에서 접속해주세요" 화면 노출 | ❌ 실패 |

---

## 4. 📊 평가 및 한계

- Charles Proxy에서 이미 **User-Agent 변조 실험은 실패한 경험이 있음**
- 당시 실패 원인은 `TLS Fingerprint` 또는 `JA3 hash` 기반의 SSL reset으로 판단됨
- mitmproxy로 다운그레이드 및 복호화는 성공했지만,
  - 차단 메커니즘은 여전히 **JS 기반 모바일 디바이스 감지**로 추정
  - User-Agent만으로는 우회 불가능 (viewport, touch support 등 JS 정보 탐지)

---

## 5. 🔜 다음 단계 계획

| 순서 | 실험 항목 | 목적 |
|------|-----------|------|
| 1️⃣ | Inspect Browser (iOS 앱) | iOS에서 PC UA + 해상도 조작 가능 브라우저로 우회 시도 |
| 2️⃣ | Headless Browser (Puppeteer) | JS 환경까지 완전 조작하여 모바일 판단 우회 |
| 3️⃣ | 출석 자동화 (PC 기반) | 모바일 우회 성공 시, 세션/쿠키 분석 후 자동화 확장 |